<html><head><title>Custom functions using WebWorker</title><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><script src="428d8a8f8fb55280f1ad.js"></script><script>let ballX=100,ballY=10,ballDirection="downRight";function animate(){setInterval(drawBall,10)}Office.onReady((function(){animate(),console.log("Office.onReady")}));const drawBall=()=>{const l=document.getElementById("mycanvas");if(l.getContext){const a=l.getContext("2d");a.clearRect(0,0,a.canvas.width,a.canvas.height),moveBall(a.canvas.width,a.canvas.height);const t=20;a.beginPath(),a.arc(ballX,ballY,t,0,2*Math.PI,!1),a.fillStyle="green",a.fill(),a.lineWidth=4,a.strokeStyle="#003300",a.stroke()}},moveBall=(l,a)=>{switch(ballX<=0&&(ballDirection="upLeft"===ballDirection?"upRight":"downRight"),ballY<=0&&(ballDirection="upLeft"===ballDirection?"downLeft":"downRight"),ballX>=l&&(ballDirection="upRight"===ballDirection?"upLeft":"downLeft"),ballY>=a&&(ballDirection="downRight"===ballDirection?"upRight":"upLeft"),ballDirection){case"upRight":ballX++,ballY--;break;case"upLeft":ballX--,ballY--;break;case"downRight":ballX++,ballY++;break;case"downLeft":ballX--,ballY++}}</script><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script><script defer="defer" src="commands.js"></script><script defer="defer" src="functions.js"></script><script defer="defer" src="functionssWorker.js"></script></head><body><script src="171319b9ff9bc26b818f.js"></script><div class="container"><h1 style="margin:8px">Custom Function Using WebWorker</h1><p>This sample shows how to use web workers in custom functions to prevent blocking the UI of your Office Add-in.</p><p></p><p><strong>Execute Custom Function without WebWorker</strong></p><p>Click the button will block the below ball</p><button type="button" id="executeCFWithoutWebWorker">Execute CF without WebWorker</button><p><strong>Execute Custom Function with WebWorker</strong></p><p>Click the button will not block the below ball</p><button type="button" id="executeCFWithWebWorker">Execute CF with WebWorker</button><p></p><canvas id="mycanvas" width="200" height="200"></canvas></div></body></html>